# 连接场景设计 - 老居民楼 & 学校

**版本**: 1.0
**更新日期**: 2026-02-08
**优先级**: P0（核心体验）

---

## 概述

老居民楼和学校是两个**外景相连**的场景，模拟2000年代中国儿童"两点一线"的上学放学日常。玩家可以在这两个场景之间自由往返，撤离点的位置取决于玩家的**起始位置**。

---

## 设计理念

### 核心概念：两点一线

2000年代的中国城镇孩子，日常生活轨迹往往只有两个点：**家**和**学校**。这条上学放学的路，承载了无数童年记忆。

- **清晨**：从家出发去学校
- **傍晚**：从学校放学回家

游戏将这种"两点一线"的体验转化为**搜打撤**的核心循环：

```
起点 → 探索/收集 → 穿越连接区域 → 到达终点（撤离点）
```

### 情感设计

| 起点场景 | 心理状态 | 撤离点意义 |
|----------|----------|------------|
| **居民楼（家）** | 安全感、熟悉 | 学校里的课桌 = 目标、期待 |
| **学校** | 任务感、压力 | 居民楼里的小床 = 归属、安息 |

---

## 场景结构

### 连接关系图

```
                    ┌─────────────────────────────────────┐
                    │                                     │
                    │         外景连接区域                 │
                    │    (黄昏小巷/上学路)                 │
                    │                                     │
                    └───────────────┬─────────────────────┘
                                    │
            ┌───────────────────────┴───────────────────────┐
            │                                               │
            ▼                                               ▼
    ┌───────────────────┐                       ┌───────────────────┐
    │                   │                       │                   │
    │   老式居民楼      │                       │   学校教学楼      │
    │   (G01)           │                       │   (G05)           │
    │                   │                       │                   │
    │  ┌─────────────┐  │                       │  ┌─────────────┐  │
    │  │ 楼道        │  │                       │  │ 走廊        │  │
    │  │ 客厅        │  │                       │  │ 教室        │  │
    │  │ 卧室        │  │                       │  │ 办公室      │  │
    │  │ 厨房        │  │                       │  │ 厕所        │  │
    │  │ 浴室        │  │                       │  │             │  │
    │  └─────────────┘  │                       │  └─────────────┘  │
    │                   │                       │                   │
    │   撤离点A:        │                       │   撤离点B:        │
    │   主角的小床      │                       │   主角的课桌      │
    │                   │                       │                   │
    └───────────────────┘                       └───────────────────┘
```

### 外景连接区域

连接区域是一条**黄昏小巷**，包含以下元素：

| 元件ID | 名称 | 功能 |
|--------|------|------|
| L01 | 老式路灯 | 光源、掩体 |
| L02 | 电线杆 | 时代标志、平台 |
| L03 | 树木 | 自然元素、遮蔽 |
| L08 | 围墙 | 边界、可翻越 |
| M01 | 熊猫垃圾桶 | 可翻找容器 |

---

## 撤离点机制

### 动态撤离点规则

```
IF 起点 == 老居民楼 THEN
    撤离点 = 学校教室里的主角课桌
    游戏目标 = "去学校"
ELSE IF 起点 == 学校 THEN
    撤离点 = 居民楼卧室里的主角小床
    游戏目标 = "回家"
END IF
```

### 撤离点详情

#### 撤离点A：主角的小床

- **位置**：老居民楼某户人家 → 卧室
- **视觉**：单人木床，叠着整齐的被子，床头有闹钟
- **触发条件**：从**学校**开始游戏时激活
- **撤离动画**：玩家躺上床，被子盖好，画面渐暗

#### 撤离点B：主角的课桌

- **位置**：学校教学楼 → 某间教室 → 靠窗的课桌
- **视觉**：木课桌，桌面有刻痕和涂鸦，抽屉里有书本
- **触发条件**：从**居民楼**开始游戏时激活
- **撤离动画**：玩家坐在课桌前，画面模糊，像是进入课堂发呆的状态

---

## 起始场景选择

### 玩家选择流程

```
梦境大厅
    │
    ├── 选择回忆节点 ──┐
    │                  │
    ▼                  ▼
┌────────────┐    ┌────────────┐
│  童年小巷  │    │  放学路上  │
│  (从家开始)│    │  (从学校开始)
│            │    │            │
│ 起点:居民楼│    │ 起点:学校  │
│ 终点:课桌  │    │ 终点:小床  │
│ 氛围:清晨  │    │ 氛围:黄昏  │
└────────────┘    └────────────┘
```

### 场景变体

| 起点选择 | 时间氛围 | 光线色调 | 背景音乐 | 叙事基调 |
|----------|----------|----------|----------|----------|
| 从家开始 | 清晨/上午 | 冷蓝渐暖金 | 轻快、期待 | 新的一天开始 |
| 从学校开始 | 黄昏/傍晚 | 暖金渐暗紫 | 怀旧、安详 | 一天结束归家 |

---

## 美术需求汇总

### 优先级 P0（两场景共用）

| 元件 | 用途 | 数量 |
|------|------|------|
| 外景连接区域背景 | 小巷/上学路 | 1-2张 |
| 老式路灯 | 光源/掩体 | 1 |
| 围墙 | 边界 | 1（可平铺） |
| 熊猫垃圾桶 | 互动容器 | 1 |

### 老居民楼（G01）P0

| 区域 | 元件 | 数量 |
|------|------|------|
| 楼道 | 楼梯、声控灯 | 2 |
| 客厅 | 沙发、电视柜 | 2 |
| 卧室 | 床（撤离点A）、衣柜、书桌 | 3 |
| 通用 | 门、窗户、墙面、地面 | 4 |

**居民楼 P0 元件总计**: 11项

### 学校（G05）P0

| 区域 | 元件 | 数量 |
|------|------|------|
| 走廊 | 走廊背景、班级牌 | 2 |
| 教室 | 黑板、讲台、课桌椅（撤离点B） | 3 |
| 通用 | 门、窗户、墙面、地面 | 4 |

**学校 P0 元件总计**: 9项

---

## 关卡流程设计

### 从居民楼开始（童年小巷）

```
1. [开场] 在居民楼某户醒来，房间熟悉又陌生
2. [探索] 搜索房间：衣柜（找到磁带）、书桌（找到照片）
3. [下楼] 经过楼道，声控灯闪烁
4. [出门] 进入外景连接区域（黄昏小巷）
5. [穿越] 沿小巷前进，翻找垃圾桶、躲避敌人
6. [到达] 抵达学校大门
7. [进入] 进入教学楼，找到自己的教室
8. [撤离] 在自己的课桌坐下，回忆涌来
9. [结算] 评估收集的回忆价值
```

### 从学校开始（放学路上）

```
1. [开场] 在教室里，下课铃响起
2. [探索] 搜索教室：课桌抽屉（找到物品）、读书角
3. [出教室] 经过走廊，名人画像注视着你
4. [下楼] 离开教学楼
5. [出门] 进入外景连接区域（上学路）
6. [穿越] 沿小巷前进，傍晚的光线
7. [到达] 抵达居民楼单元门
8. [进入] 上楼，回到熟悉的家门口
9. [撤离] 躺在自己的小床上，安心入睡
10. [结算] 评估收集的回忆价值
```

---

## 技术实现要点

### 场景切换

```javascript
// 场景切换触发点
const sceneTransitions = {
    residentialToStreet: {
        from: "residential_building_exit",
        to: "connecting_street",
        direction: "right"
    },
    streetToResidential: {
        from: "connecting_street_left",
        to: "residential_building_entrance",
        direction: "left"
    },
    streetToSchool: {
        from: "connecting_street_right",
        to: "school_building_entrance",
        direction: "right"
    },
    schoolToStreet: {
        from: "school_building_exit",
        to: "connecting_street",
        direction: "left"
    }
};
```

### 撤离点状态管理

```javascript
// 撤离点配置
const extractionPoints = {
    // 撤离点A：居民楼小床（从学校开始时激活）
    bedExtraction: {
        mapId: "residential_building_bedroom",
        x: 5,
        y: 3,
        activeWhen: "startPoint == 'school'",
        interactionText: "躺在床上休息..."
    },
    // 撤离点B：学校课桌（从居民楼开始时激活）
    deskExtraction: {
        mapId: "school_classroom",
        x: 8,
        y: 5,
        activeWhen: "startPoint == 'residential'",
        interactionText: "坐在课桌前..."
    }
};
```

---

## 开发任务清单

### Phase 1.1 - 老居民楼（P0）

- [ ] G01 老居民楼外景背景（含怪核氛围）
- [ ] I-001 楼梯
- [ ] I-002 声控灯
- [ ] I-006 沙发
- [ ] I-007 电视柜
- [ ] I-012 床（撤离点A）
- [ ] I-013 衣柜
- [ ] I-014 书桌
- [ ] I-GEN-01~04 通用组件（门、窗、墙、地）

### Phase 1.2 - 外景连接区域（P0）

- [ ] 黄昏小巷背景
- [ ] L01 老式路灯
- [ ] L08 围墙
- [ ] M01 熊猫垃圾桶

### Phase 1.3 - 学校（P0）

- [ ] G05 学校教学楼外景背景
- [ ] I-043 走廊背景
- [ ] I-046 班级牌
- [ ] I-049 黑板
- [ ] I-050 讲台
- [ ] I-051 课桌椅（撤离点B）
- [ ] 通用组件复用

---

## 更新日志

| 日期 | 版本 | 更新内容 |
|------|------|----------|
| 2026-02-08 | 1.0 | 创建文档，定义老居民楼和学校的连接机制 |
